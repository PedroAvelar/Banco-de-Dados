/* EXEMPLO - PROCESSO DE EXPORT/IMPORT
Primeiramente verificar o tamanho do owner ou de determinada tabela na base de produção para calcular todo o espaço que será necessário
para o refresh.
Deve-se calcular para área de TEMP e UNDO aproximadamente o tamanho total do owner ou tabela + 50GB.*/

--Verificar o tamanho do objeto que será exportado(Base Origem).
select owner,segment_name,tablespace_name,sum(bytes/1024/1024)
from dba_segments
where segment_name = 'NOME_OBJETO'
and owner = 'ADM'
group by owner,segment_name,tablespace_name;

--Verificar o tamanho do owner que será exportado(Base Origem).
select owner,sum(bytes/1024/1024)
from dba_segments
where owner = 'NOME_OWNER'
group by owner;

--Verificar qual o segmento de TEMP que o banco está utilizando(Base Destino).
select * from v$tempseg_usage;

--Verificar o tamanho da TEMP, deixar equivalente ao tamanho do owner + 50GB(Base Destino).
select * from dba_temp_files where tablespace_name = 'NOME_TEMP';
select tablespace_name,sum(bytes/1024/1024) from dba_temp_files where tablespace_name = 'TEMP1' group by tablespace_name;
/* alter tablespace NOME_TEMP add tempfile 'caminho/tempfile_01.dbf' size tamanhom; */

--Caso seja necessário criar uma nova TEMP(Base Destino), em seguida setar o parâmetro o Banco.
--Primeiramente guardar o código de criação do segmento:
select dbms_metadata.get_ddl('TABLESPACE','NOME_TEMP') from dual;
create temporary tablespace NOME_TEMP tempfile 'caminho/tempfile_01.dbf' size tamanhom;
alter database default temporary tablespace NOME_TEMP;

--Verificar qual o segmento de UNDO que o banco está utilizando(Base Destino).
show parameter undo_tablespace;

--Verificar o tamanho da UNDO, deixar equivalente ao tamanho do owner + 50GB(Base Destino).
select tablespace_name,sum(bytes/1024/1024)
from dba_segments
where tablespace_name = 'NOME_UNDO'
group by tablespace_name;

--Caso seja necessário criar um novo segmento UNDO(Base Destino), em seguida setar o parâmetro o Banco.
--Primeiramente guardar o código de criação do segmento:
select dbms_metadata.get_ddl('TABLESPACE','NOME_UNDO') from dual;
create undo tablespace NOME_UNDO datafile 'caminho/undo_01.dbf' size tamanhom;
alter system set undo_tablespace = NOME_UNDO;
